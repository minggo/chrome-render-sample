{"version":3,"file":"meshopt_decoder.wasm-ebbcb6df.js","sources":["../../../../../../../../../../external:emscripten/meshopt/meshopt_decoder.wasm.js"],"sourcesContent":["// This file is part of meshoptimizer library and is distributed under the terms of MIT License.\n// Copyright (C) 2016-2023, by Arseny Kapoulkine (arseny.kapoulkine@gmail.com)\nvar MeshoptDecoder = (function() {\n\t\"use strict\";\n\n\tvar instance;\n\tvar supported = false;\n\n\tvar ready = (instantiateWasm = {}) => {\n\n\t\tif (typeof instantiateWasm !== 'function') {\n\t\t\treturn Promise.reject(new Error('No wasm support detected'));\n\t\t}\n\n\t\treturn instantiateWasm().then(function(result) {\n\t\t\tsupported = true;\n\t\t\tinstance = result.instance;\n\t\t\tinstance.exports.__wasm_call_ctors();\n\t\t});\n\t}\n\n\tfunction decode(fun, target, count, size, source, filter) {\n\t\tvar sbrk = instance.exports.sbrk;\n\t\tvar count4 = (count + 3) & ~3;\n\t\tvar tp = sbrk(count4 * size);\n\t\tvar sp = sbrk(source.length);\n\t\tvar heap = new Uint8Array(instance.exports.memory.buffer);\n\t\theap.set(source, sp);\n\t\tvar res = fun(tp, count, size, sp, source.length);\n\t\tif (res == 0 && filter) {\n\t\t\tfilter(tp, count4, size);\n\t\t}\n\t\ttarget.set(heap.subarray(tp, tp + count * size));\n\t\tsbrk(tp - sbrk(0));\n\t\tif (res != 0) {\n\t\t\tthrow new Error(\"Malformed buffer data: \" + res);\n\t\t}\n\t}\n\n\tvar filters = {\n\t\tNONE: \"\",\n\t\tOCTAHEDRAL: \"meshopt_decodeFilterOct\",\n\t\tQUATERNION: \"meshopt_decodeFilterQuat\",\n\t\tEXPONENTIAL: \"meshopt_decodeFilterExp\",\n\t};\n\n\tvar decoders = {\n\t\tATTRIBUTES: \"meshopt_decodeVertexBuffer\",\n\t\tTRIANGLES: \"meshopt_decodeIndexBuffer\",\n\t\tINDICES: \"meshopt_decodeIndexSequence\",\n\t};\n\n\tvar workers = [];\n\tvar requestId = 0;\n\n\tfunction createWorker(url) {\n\t\tvar worker = {\n\t\t\tobject: new Worker(url),\n\t\t\tpending: 0,\n\t\t\trequests: {}\n\t\t};\n\n\t\tworker.object.onmessage = function(event) {\n\t\t\tvar data = event.data;\n\n\t\t\tworker.pending -= data.count;\n\t\t\tworker.requests[data.id][data.action](data.value);\n\n\t\t\tdelete worker.requests[data.id];\n\t\t};\n\n\t\treturn worker;\n\t}\n\n\tfunction initWorkers(count) {\n\t\tvar source =\n\t\t\t\"var instance; var ready = WebAssembly.instantiate(new Uint8Array([\" + new Uint8Array(unpack(wasm)) + \"]), {})\" +\n\t\t\t\".then(function(result) { instance = result.instance; instance.exports.__wasm_call_ctors(); });\" +\n\t\t\t\"self.onmessage = workerProcess;\" +\n\t\t\tdecode.toString() + workerProcess.toString();\n\n\t\tvar blob = new Blob([source], {type: 'text/javascript'});\n\t\tvar url = URL.createObjectURL(blob);\n\n\t\tfor (var i = 0; i < count; ++i) {\n\t\t\tworkers[i] = createWorker(url);\n\t\t}\n\n\t\tURL.revokeObjectURL(url);\n\t}\n\n\tfunction decodeWorker(count, size, source, mode, filter) {\n\t\tvar worker = workers[0];\n\n\t\tfor (var i = 1; i < workers.length; ++i) {\n\t\t\tif (workers[i].pending < worker.pending) {\n\t\t\t\tworker = workers[i];\n\t\t\t}\n\t\t}\n\n\t\treturn new Promise(function (resolve, reject) {\n\t\t\tvar data = new Uint8Array(source);\n\t\t\tvar id = requestId++;\n\n\t\t\tworker.pending += count;\n\t\t\tworker.requests[id] = { resolve: resolve, reject: reject };\n\t\t\tworker.object.postMessage({ id: id, count: count, size: size, source: data, mode: mode, filter: filter }, [ data.buffer ]);\n\t\t});\n\t}\n\n\tfunction workerProcess(event) {\n\t\tready.then(function() {\n\t\t\tvar data = event.data;\n\t\t\ttry {\n\t\t\t\tvar target = new Uint8Array(data.count * data.size);\n\t\t\t\tdecode(instance.exports[data.mode], target, data.count, data.size, data.source, instance.exports[data.filter]);\n\t\t\t\tself.postMessage({ id: data.id, count: data.count, action: \"resolve\", value: target }, [ target.buffer ]);\n\t\t\t} catch (error) {\n\t\t\t\tself.postMessage({ id: data.id, count: data.count, action: \"reject\", value: error });\n\t\t\t}\n\t\t});\n\t}\n\n\treturn {\n\t\tready: ready,\n\t\tsupported: supported,\n\t\tuseWorkers: function(count) {\n\t\t\tinitWorkers(count);\n\t\t},\n\t\tdecodeVertexBuffer: function(target, count, size, source, filter) {\n\t\t\tdecode(instance.exports.meshopt_decodeVertexBuffer, target, count, size, source, instance.exports[filters[filter]]);\n\t\t},\n\t\tdecodeIndexBuffer: function(target, count, size, source) {\n\t\t\tdecode(instance.exports.meshopt_decodeIndexBuffer, target, count, size, source);\n\t\t},\n\t\tdecodeIndexSequence: function(target, count, size, source) {\n\t\t\tdecode(instance.exports.meshopt_decodeIndexSequence, target, count, size, source);\n\t\t},\n\t\tdecodeGltfBuffer: function(target, count, size, source, mode, filter) {\n\t\t\tdecode(instance.exports[decoders[mode]], target, count, size, source, instance.exports[filters[filter]]);\n\t\t},\n\t\tdecodeGltfBufferAsync: function(count, size, source, mode, filter) {\n\t\t\tif (workers.length > 0) {\n\t\t\t\treturn decodeWorker(count, size, source, decoders[mode], filters[filter]);\n\t\t\t}\n\n\t\t\treturn ready.then(function() {\n\t\t\t\tvar target = new Uint8Array(count * size);\n\t\t\t\tdecode(instance.exports[decoders[mode]], target, count, size, source, instance.exports[filters[filter]]);\n\t\t\t\treturn target;\n\t\t\t});\n\t\t}\n\t};\n})();\n\nexport default MeshoptDecoder;"],"names":["MeshoptDecoder","instance","supported","ready","instantiateWasm","Promise","reject","Error","then","result","exports","__wasm_call_ctors","decode","fun","target","count","size","source","filter","sbrk","count4","tp","sp","length","heap","Uint8Array","memory","buffer","set","res","subarray","filters","NONE","OCTAHEDRAL","QUATERNION","EXPONENTIAL","decoders","ATTRIBUTES","TRIANGLES","INDICES","workers","requestId","createWorker","url","worker","object","Worker","pending","requests","onmessage","event","data","id","action","value","initWorkers","unpack","wasm","toString","workerProcess","blob","Blob","type","URL","createObjectURL","i","revokeObjectURL","decodeWorker","mode","resolve","postMessage","self","error","useWorkers","decodeVertexBuffer","meshopt_decodeVertexBuffer","decodeIndexBuffer","meshopt_decodeIndexBuffer","decodeIndexSequence","meshopt_decodeIndexSequence","decodeGltfBuffer","decodeGltfBufferAsync"],"mappings":"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"}